<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Iphone breakdown</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>
    <style type="text/css">
    svg {
        margin-left:auto;
        margin-right:auto;
        display:block;
    }
    .graphic{
        display:block;
        margin: 10px auto;
    }
    #legend {
        position: absolute;
        top: 450px;
        right: 200px;
    }
    #title{
        text-align: center;
        color: #969696;
        font-family: sans-serif;
        font-size: 20px;
    }
    /* Controls */
    div#controls {
        position: absolute;
        left: 480px;
        top: 500px;
        padding: 24px 0px 12px 0px;
        text-align: center;
        font-size: 12px;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
    }

    span.arrow {
      cursor: pointer;
      background-color: #444;
      opacity: 0.7;
      color: #fff;
      padding: 8px 15px;
      border-radius: 4px;
      -moz-border-radius: 4px;
      -webkit-border-radius: 4px;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      font-weight: 900;
  }

  span.arrow:hover {
      background-color: #000;
  }

  div#controls.disabled {
      opacity: 0.7;
  }

  span.arrow.disabled {
      opacity: 0.5;
  }

  span.arrow.disabled:hover {
      background-color: #444;
      opacity: 0.5;
  }

  i.pip {
      margin: 0px 5px;
      cursor: pointer;
  }

  i.pip.past {
      opacity: 0.4;
  }

  i.pip.current {
      color: #2baa91;
      cursor: auto;
  }

  .fa {
    display: inline-block;
    font-family: FontAwesome;
    font-style: normal;
    font-weight: normal;
    line-height: 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.fa-circle:before {
    content: "\f111";
    color:#2baa91;
}

#containerLevel0 svg {
    position: relative;
    left: 100px;
}
#containerLevel1, #containerLevel2 {
    min-width: 850px;
    height: 800px;
    display: block;
}

#containerLevel1 h3{
    text-align: left;
    padding-left: 20px;
    font-size: 13px;
}
#containerLevel2 h4 {
    padding-left: 10px;
}

#containerLevel1 .level1 {
    display:inline-block;
    font-family: sans-serif;
    color:#949494;
    font-size: 12px;
    margin: 10px 10px;
}

#containerLevel2 .level2 {
    display:inline-block;
    float:left;
    font-family: sans-serif;
    color:#949494;
    font-size: 11px;
    margin: 20px 15px;
    height: 80px;
}

.container {
    margin: 20px 50px;
}

p{
    position:relative;
    padding-left: 100px;
    padding-right: 100px;
    color: #969696;
    font-family: 'Open Sans Condensed', sans-serif;
    font-size: 18px;
}

#red{
    color:#CC3E21;
    font-weight: bold; 
}

#green{
    color:#2BAA91;
    font-weight: bold; 
}

#blue{
    color:#4283D1;        
    font-weight: bold; 
}

#yellow{
    color:#FFBB00;
    font-weight: bold; 
}
#number{
    font-family: 'Open Sans Condensed', sans-serif;
}

</style>
</head>
<body>

    <h2 id="title"> Breaking down the full $650 cost of the iPhone 5</h2>
    
    <div id="containerLevel0" class="container" >
        <p>Do you know how much money Apple is making off every device it sells? This cost calculation is for the USA edition of both the iPhone 5 with 16GB of internal file storage and LTE connectivity. Every variation of a device has a different Bill of Materials, so even changing the color of a phone might alter its price by a little. </p>

    </div>



    <div id="containerLevel1" class="container" style="display:none">
        <p>We break down the full $650 cost of the iPhone 5 into four components: <span id="green">Manufacturing</span>, <span id="red">Operating Expenses</span>, <span id="blue">Wholesale to Retail Markup </span> and <span id="yellow">Profit</span>.</p>
        <div id="manufacturing" class="level1">
            <h3 id="manufacturing1">Manufacturing <span id="number"> ($225.85)</span></h3>
        </div>
        <div id="operating" class="level1">
            <h3 id="operating1">Operating Expenses <span id="number"> ($61.18)</span></h3>
        </div>
        <div id="wholesale" class="level1">
            <h3 id="wholesale1">Wholesale to Retail Markup <span id="number"> ($68.9)</span></h3>
        </div>
        <div id="profit" class="level1">
            <h3 id="profit1">Profit <span id="number"> ($293.06)</span></h3>
        </div>


    <!-- end of #containerLevel1-->
    </div>

    <div id="containerLevel2" class="container" style="display:none">
        <p>Let's further break down its manufacturing cost and add up the price of all the components and materials inside iPhone.There are dozens of components ranging from processors to displays to gyrometers, and they range in price from a few dollars to $30 and up.</p>
        <div id="flash" class="level2"><h4 id="flash2">Flash Memory &amp RAM<span id="number"> ($20.85)</span></h4>
        </div>
        <div id="display" class="level2"><h4 id="display2">Display &amp Touchscreen<span id="number"> ($44)</span></h4>
        </div>
        <div id="processor" class="level2"><h4 id="processor2">Processor<span id="number"> ($17.5)</span></h4>
        </div>
        <div id="sensor" class="level2"><h4 id="sensor2">Sensors<span id="number"> ($6.5)</span></h4>
        </div>
        <div id="camera" class="level2"><h4 id="camera2">Cameras<span id="number"> ($18)</span></h4>
        </div>
        <div id="cellular" class="level2"><h4 id="cellular2">Cellular Radio<span id="number"> ($34)</span></h4>
        </div>
        <div id="wireless" class="level2"><h4 id="wireless2">Wireless Radio<span id="number"> ($5)</span></h4>
        </div>
        <div id="battery" class="level2"><h4 id="battery2">Battery<span id="number"> ($4.5)</span></h4>
        </div>
        <div id="power" class="level2"><h4 id="power2">Power Management<span id="number"> ($8.5)</span></h4>
        </div>
        <div id="mechanical" class="level2"><h4 id="mechanical2">Mechanical Parts<span id="number"> ($33)</span></h4>
        </div>
        <div id="packaging" class="level2"><h4 id="packaging2">Packaging<span id="number"> ($7)</span></h4>
        </div>
        <div id="production" class="level2"><h4 id="production2">Production<span id="number"> ($8)</span></h4>
        </div>
        <div id="licensing" class="level2"><h4 id="licensing2">Licensing Fees<span id="number"> ($20)</span></h4>
        </div>
    <!-- end of #containerLevel2-->
    </div>
    <div id="legend"></div>

    <div id="controls">
        <span class="arrow" id="prev">PREV</span>
        <i class="pip fa fa-circle"></i>
        <i class="pip fa fa-circle"></i>
        <i class="pip fa fa-circle"></i>
        <span class="arrow" id="next">NEXT</span>
    </div>
    <script src="font-awesome.min.css"></script>
    <script src="./d3.js" charset="utf-8"></script>
    <script type="text/javascript" src="jquery-2.1.4.min.js"></script>
    <script type="text/javascript">

        var NEXT_PAGE_COUNT = 2;
        var width  = 850,
        height = 800;
        
        var svg = d3.select("#containerLevel0")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", width)
        .attr("height", height);

        var manufacturing = d3.select("#manufacturing")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 250)
        .attr("height", 300);

        var operating = d3.select("#operating")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 250)
        .attr("height", 300);

        var profit = d3.select("#profit")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 250)
        .attr("height", 300);

        var wholesale = d3.select("#wholesale")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 250)
        .attr("height", 300);

        var flash = d3.select("#flash")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var display = d3.select("#display")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var processor = d3.select("#processor")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var sensor = d3.select("#sensor")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var camera = d3.select("#camera")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var cellular = d3.select("#cellular")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var wireless = d3.select("#wireless")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var battery = d3.select("#battery")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var power = d3.select("#power")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var mechanical = d3.select("#mechanical")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var packaging = d3.select("#packaging")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var production = d3.select("#production")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var licensing = d3.select("#licensing")
        .append("svg")
        .attr("class", "graphic")
        .attr("width", 200)
        .attr("height", 150);

        var howManyAcross = Math.floor(width / 25) - 1;
        var howManyAcrossSmall = Math.floor(width / 50) - 1;


        var thedata = [];

        var thecolor =["#2BAA91","#CC3E21","#4283D1","#FFBB00"];

        var category =["Manufacturing","Operating Expenses","Wholesale to Retail Markup","Profit"];

        var newArray =[];
        var secondArray=[];
        var thirdArray=[];
        var fourthArray=[];
        var flash1=[];
        var display1=[];
        var processor1=[];
        var sensor1=[];
        var camera1=[];
        var cellular1=[];
        var wireless1=[];
        var battery1=[];
        var power1=[];
        var mechanical1=[];
        var packaging1=[];
        var production1=[];
        var licensing1=[];

        for(var i=0; i < 650; i++){
            if(i<=226){
                thedata[i] = '#2BAA91';         
            } else if(i < 288 && i>= 227) {
                thedata[i]='#CC3E21';
            } else if(i <357 && i>=287){
                thedata[i]='#4283D1';
            }
            else{
                thedata[i]='#FFBB00';
            }
        };

        for(var i=0; i< 226;i++){
            newArray[i]="xx";
        }

        for(var i=0; i< 60;i++){
            secondArray[i]="yy";
        }

        for(var i=0; i< 68;i++){
            thirdArray[i]="yy";
        }

        for(var i=0; i< 292;i++){
            fourthArray[i]="yy";
        }

        for(var i=0; i< 21;i++){
            flash1[i]="xx";
        }

        for(var i=0; i< 44;i++){
            display1[i]="yy";
        }

        for(var i=0; i< 18;i++){
            processor1[i]="yy";
        }

        for(var i=0; i< 6;i++){
            sensor1[i]="yy";
        }

        for(var i=0; i< 18;i++){
            camera1[i]="yy";
        }

        for(var i=0; i< 34;i++){
            cellular1[i]="yy";
        }

        for(var i=0; i< 5;i++){
            wireless1[i]="yy";
        }

        for(var i=0; i< 5;i++){
            battery1[i]="yy";
        }

        for(var i=0; i< 8;i++){
            power1[i]="yy";
        }

        for(var i=0; i< 33;i++){
            mechanical1[i]="yy";
        }

        for(var i=0; i< 7;i++){
            packaging1[i]="yy";
        }

        for(var i=0; i< 8;i++){
            production1[i]="yy";
        }  

        for(var i=0; i< 20;i++){
            licensing1[i]="yy";
        } 

        svg.selectAll("g")
        .data(thedata)
        .enter()
        .append("g")
        .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcross) * 17) + "," + (Math.floor(i/howManyAcross) * 17) + ")"})
        .append('rect')
        .attr("width",50)
        .attr("height",50)
        .attr("transform","scale(0.3)")
        .style("fill", function(d){ return d; });


        var info= d3.select("#legend")
        .append("svg")
        .attr("width", 400)
        .attr("height", 100)
        .selectAll('g')
        .data(thecolor)
        .enter()
        .append('g')
        .attr("x",800);

        info      
        .append('rect')
        .attr("width",50)
        .attr("height",50)
        .attr("transform", function(d,i){
            return "scale(0.3) translate(" + (400) + ' ' + (100 + 60*i) +  ")";
        })
        .style("fill", function(d){ return d; });


        info
        .selectAll("g")
        .data(category)
        .enter()
        .append("g")
        .attr("transform", function(d,i){
            return "scale(0.3) translate(" + (520) + ' ' + (140 + 60*i) +  ")"
        })
        .append('text')
        .text(function(d){return d})
        .style("font-size","30px");


            manufacturing.selectAll("g")
            .data(newArray)
            .enter()
            .append("g")
            .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 14) + "," + (Math.floor(i/howManyAcrossSmall) * 14) + ")"})
            .append('rect')
            .attr("width",40)
            .attr("height",40)
            .attr("transform","scale(0.3)") 
            .style("fill", "white")                                   
            .transition()
            .duration(3000)
            .delay(function(d,i){ return i * 10;})
            .style("fill", "#2BAA91");


            operating.selectAll("g")
            .data(secondArray)
            .enter()
            .append("g")
            .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 14) + "," + (Math.floor(i/howManyAcrossSmall) * 14) + ")"})
            .append('rect')
            .attr("width",40)
            .attr("height",40)
            .attr("transform","scale(0.3)") 
            .style("fill", "white")                                   
            .transition()
            .duration(5000)
            .delay(function(d,i){ return i * 10;})
            .style("fill", "#CC3E21");

            wholesale.selectAll("g")
            .data(thirdArray)
            .enter()
            .append("g")
            .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 14) + "," + (Math.floor(i/howManyAcrossSmall) * 14) + ")"})
            .append('rect')
            .attr("width",40)
            .attr("height",40)
            .attr("transform","scale(0.3)") 
            .style("fill", "white")                                   
            .transition()
            .duration(3000)
            .delay(function(d,i){ return i * 10;})
            .style("fill", "#4283D1");


            profit.selectAll("g")
            .data(fourthArray)
            .enter()
            .append("g")
            .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 14) + "," + (Math.floor(i/howManyAcrossSmall) * 14) + ")"})
            .append('rect')
            .attr("width",40)
            .attr("height",40)
            .attr("transform","scale(0.3)") 
            .style("fill", "white")                                   
            .transition()
            .duration(5000)
            .delay(function(d,i){ return i * 10;})
            .style("fill", "#FFBB00");



    flash.selectAll("g")
    .data(flash1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");


    display.selectAll("g")
    .data(display1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");

    processor.selectAll("g")
    .data(processor1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");


    sensor.selectAll("g")
    .data(sensor1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");

    camera.selectAll("g")
    .data(camera1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");

    cellular.selectAll("g")
    .data(cellular1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");

    wireless.selectAll("g")
    .data(wireless1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");

    battery.selectAll("g")
    .data(battery1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");

    power.selectAll("g")
    .data(power1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");

    mechanical.selectAll("g")
    .data(mechanical1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");

    packaging.selectAll("g")
    .data(packaging1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");

    production.selectAll("g")
    .data(production1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");

    licensing.selectAll("g")
    .data(licensing1)
    .enter()
    .append("g")
    .attr("transform", function(d, i){ return "translate(" + ((i % howManyAcrossSmall) * 10) + "," + (Math.floor(i/howManyAcrossSmall) * 10) + ")"})
    .append('rect')
    .attr("width",30)
    .attr("height",30)
    .attr("transform","scale(0.3)") 
    .style("fill", "white")                                   
    .transition()
    .duration(1000)
    .style("fill", "#2BAA91");



    var currentNextIndex = 0;
    $('#prev').click(function(){
        console.log(currentNextIndex);
        if (currentNextIndex < 1) {
            return;
        }
        $('#containerLevel' + currentNextIndex).hide();
        currentNextIndex -= 1;
        if(currentNextIndex==2){
            $('#legend').hide();
        }else{
            $('#legend').show();
        };
        $('#containerLevel' + currentNextIndex).show();
    });
    $('#next').click(function(){
        console.log(currentNextIndex);
        if (currentNextIndex>= NEXT_PAGE_COUNT) {
            return;
        }
        $('#containerLevel' + currentNextIndex).hide();

        currentNextIndex += 1;
        if(currentNextIndex==2){
            $('#legend').hide();
        }else{
            $('#legend').show();
        };
        
        $('#containerLevel' + currentNextIndex).show();
    });






</script>
</body>
</html>